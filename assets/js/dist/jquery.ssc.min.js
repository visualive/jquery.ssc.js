/*!
 * Social Shared Count - jQuery plugin
 * Author: KUCKLU ( VisuAlive )
 * Created date: 11.27.2014
 * Updated date: 06.18.2017
 * Version: 1.1.10
 * Licensed under the MIT license or GNU General Public License v3
 */
!function(t,e,n,s){"use strict";function i(t){var e=parseInt(t,10);return null===e?0:e>=1e9?(e/1e9).toFixed(1).replace(/\.0$/,"")+"G":e>=1e6?(e/1e6).toFixed(1).replace(/\.0$/,"")+"M":e>=1e3?(e/1e3).toFixed(1).replace(/\.0$/,"")+"K":e}var a,l={facebook:!1,twitter:!1,google:!1,hatena:!1,linkedin:!1,pocket:!1,twitterVia:null,twitterRelated:null};return a=function(e,a){return{init:function(){this.settings=t.extend({},l,a),this.triggerHolder=e,this.$container=t(e),this.$url=t(e).attr("data-ssc-url"),this.$title=t(e).attr("data-ssc-title"),this.sns={facebook:{name:"Facebook",url:"https://www.facebook.com/sharer/sharer.php?t="+encodeURIComponent(this.$title)+"&u="+encodeURIComponent(this._sanitizeUrl(this.$url))},twitter:{name:"Twitter",url:"https://twitter.com/intent/tweet?text="+encodeURIComponent(this.$title)+"&url="+encodeURIComponent(this._sanitizeUrl(this.$url))+this._sanitizeText(this.settings.twitterVia,"via")+this._sanitizeText(this.settings.twitterRelated,"related")},google:{name:"Google+",url:"https://plus.google.com/share?hl="+encodeURIComponent(this.$title)+"&url="+encodeURIComponent(this._sanitizeUrl(this.$url))},hatena:{name:"Hatena",url:"http://b.hatena.ne.jp/append?"+encodeURIComponent(this._sanitizeUrl(this.$url))},linkedin:{name:"LinkedIn",url:"https://www.linkedin.com/shareArticle?mini=true&title="+encodeURIComponent(this.$title)+"&url="+encodeURIComponent(this._sanitizeUrl(this.$url))},pocket:{name:"Pocket",url:"https://getpocket.com/save?title="+encodeURIComponent(this.$title)+"&url="+encodeURIComponent(this._sanitizeUrl(this.$url))}},this.listClass=String(this.triggerHolder.className)+"_list",this.listItemClass=String(this.listClass)+"_items",this.anchorClass=String(this.listItemClass)+"_anchor",this.snsNameClass=String(this.listItemClass)+"_name",this.countClass=String(this.listItemClass)+"_count",this.$url&&null!==this._sanitizeUrl(this.$url)&&this.$title&&(this._createCountBox(),this.settings.facebook===!0&&this._facebook(),this.settings.twitter===!0&&this._twitter(),this.settings.google===!0&&this._google(),this.settings.hatena===!0&&this._hatena(),this.settings.linkedin===!0&&this._linkedin(),this.settings.pocket===!0&&this._pocket())},_sanitizeHtml:function(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/"/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},_sanitizeText:function(t,e){if(t!==s||null!==t){var n=t.match(/^[\w]+$/i);return"via"===e?null!==n?"&via="+encodeURIComponent(n[0]):"":"related"===e?null!==n?"&related="+encodeURIComponent(n[0]):"":null!==n?n[0]:""}return""},_sanitizeUrl:function(t){if(t!==s||null!==t){var e=t.match(/^https?:\/\/[-_.!~*\"()a-zA-Z0-9;\/?:\@&=+\$,%#]+$/i);return null!==e?e[0]:null}return""},_createCountBox:function(){var t=this.$container,e=n.createElement("ul"),s=[];e.className=String(this.listClass);for(var i in this.sns)this.settings[i]===!0&&s.push('<li class="'+String(this.listItemClass)+" "+String(this.listItemClass)+"-"+i+'"><a class="'+String(this.anchorClass)+'" href="'+this.sns[i].url+'" target="_blank"><span class="'+String(this.snsNameClass)+'">'+this._sanitizeHtml(this.sns[i].name)+'</span><span class="'+String(this.countClass)+'">0</span></a></li>');t[0].appendChild(e),e.insertAdjacentHTML("afterbegin",s.join(""))},_countElements:function(t){var e=this.$container;return e.find("."+String(this.listItemClass)+"-"+t).find("."+String(this.countClass))},_facebook:function(){var e=this._countElements("facebook");t.ajax({type:"GET",dataType:"jsonp",cache:!0,async:!0,timeout:5e3,url:"https://graph.facebook.com/",data:{id:this.$url}}).then(function(t){var n=s!==t.share&&null!==t.share?i(t.share.share_count):0;e.text(n)},function(){e.text(0)})},_twitter:function(){var e=this._countElements("twitter");t.ajax({type:"GET",dataType:"jsonp",cache:!0,async:!0,url:"https://opensharecount.com/count.json?callback=?",data:{url:this.$url}}).then(function(t){var n=i(t.count);e.text(n)},function(){e.text(0)})},_google:function(){var e=this._countElements("google");t.ajax({type:"GET",dataType:"json",cache:!0,async:!0,url:"https://query.yahooapis.com/v1/public/yql",data:{q:'select * from htmlstring where url="https://plusone.google.com/_/+1/fastbutton?hl=ja&url='+this.$url+"\" AND xpath='//div'",format:"json",env:"store://datatables.org/alltableswithkeys"}}).then(function(t){var n=new DOMParser,s=n.parseFromString(t.query.results.result,"text/html"),a=null!==s.getElementById("aggregateCount")?i(s.getElementById("aggregateCount").innerText):0;e.text(a)},function(){e.text(0)})},_hatena:function(){var e=this._countElements("hatena");t.ajax({type:"GET",dataType:"jsonp",cache:!0,async:!0,url:"https://b.hatena.ne.jp/entry.count?callback=?",data:{url:this.$url}}).then(function(t){var n=i(t);e.text(n)},function(){e.text(0)})},_linkedin:function(){var e=this._countElements("linkedin");t.ajax({type:"GET",dataType:"jsonp",cache:!0,async:!0,url:"https://www.linkedin.com/countserv/count/share?callback=?",data:{url:this.$url}}).then(function(t){var n=i(t.count);e.text(n)},function(){e.text(0)})},_pocket:function(){var e=this._countElements("pocket");t.ajax({type:"GET",dataType:"json",cache:!0,async:!0,url:"https://query.yahooapis.com/v1/public/yql",data:{q:'select * from htmlstring where url="https://widgets.getpocket.com/v1/button?label=pocket&count=horizontal&v=1&url='+this.$url+"&src="+this.$url+"\" AND xpath='//div'",format:"json",env:"store://datatables.org/alltableswithkeys"}}).then(function(t){var n=new DOMParser,s=n.parseFromString(t.query.results.result,"text/html"),a=null!==s.getElementById("cnt")?i(s.getElementById("cnt").innerText):0;e.text(a)},function(){e.text(0)})}}},a.defaults=l,t.fn.socialSharedCount=function(t){return this.each(function(){new a(this,t).init()})},a}(window.jQuery,window,document);